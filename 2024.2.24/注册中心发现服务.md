
> > ç›¸ä¿¡å¤§å®¶ç¢°åˆ°æºç æ—¶ç»å¸¸æ— ä»ä¸‹æ‰‹ğŸ™ƒï¼Œä¸çŸ¥é“ä»å“ªå¼€å§‹é˜…è¯»ï¼Œé¢å¯¹å¤§é‡ä»£ç æ™•å¤´è½¬å‘ï¼Œç´¢æ€§å°±è¯»ä¸ä¸‹å»äº†ï¼Œåˆæµªè´¹äº†ä¸€æ¬¡æå‡è‡ªå·±çš„æœºä¼šğŸ˜­ã€‚
> >
> > <br/>
> >
> > æˆ‘è®¤ä¸º**æœ‰ä¸€ç§æ–¹æ³•**ï¼Œå¯ä»¥è§£å†³å¤§å®¶çš„å›°æ‰°ï¼**é‚£å°±æ˜¯é€šè¿‡é˜…è¯»æŸä¸€æ¬¡å¼€æºçš„ã€PRã€‘ã€ã€ISSUEã€‘ï¼Œä»è¿™ä¸ªå…¥å£å‡ºå‘å»é˜…è¯»æºç ï¼ï¼**
> >
> > <br/>
> >
> > è‡³æ­¤ï¼Œæˆ‘ä»¬å‘ç°è‡ªå·±å¼€å§‹ä»å¤§é‡å †ç Œçš„æºç ä¸­è„±ç¦»å¼€æ¥ğŸ˜€ã€‚è±ç„¶å¼€æœ—ï¼ŒæŸ³æš—èŠ±æ˜åˆä¸€æ‘ğŸ€ã€‚
>
>
> ShenYuæ˜¯ä¸€ä¸ªå¼‚æ­¥çš„ï¼Œé«˜æ€§èƒ½çš„ï¼Œè·¨è¯­è¨€çš„ï¼Œå“åº”å¼çš„ API ç½‘å…³ã€‚æœ‰å…³ShenYuçš„ä»‹ç»å¯ä»¥[æˆ³è¿™](https://shenyu.apache.org/zh/docs/index/)ã€‚
> ## ä¸€ã€å‰ç»
>
> è¯ä¸å¤šè¯´ï¼Œå¥‰ä¸Šä»Šå¤©æˆ‘ä»¬æ¥é˜…è¯»çš„[PRæäº¤](https://github.com/apache/shenyu/pull/5193)ã€‚
>
> ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/direct/2db06b86575d4959aad6e50578e4c19f.png#pic_center)
>
>
> ç¿»è¯‘è¿‡æ¥å°±æ˜¯ï¼Œæ·»åŠ nacosã€etcdã€eurekaå‘ç°æœåŠ¡ã€‚
>
> æˆ‘ä»¬å…ˆæ€è€ƒä¸‹æˆ‘ä»¬çš„**é˜…è¯»çº¿ç´¢**
>
> 1. è´¡çŒ®è€…æ˜¯**æ€ä¹ˆæ·»åŠ **å‘ç°æœåŠ¡çš„
> 2. è¿™äº›**å‘ç°æœåŠ¡**æ˜¯æ€ä¹ˆå’Œé¡¹ç›®é›†æˆçš„ï¼Œè®©ShenYuç½‘å…³èƒ½ä»æ³¨å†Œä¸­å¿ƒ**è·å–èŠ‚ç‚¹ä¿¡æ¯**
>
> 
>
> ## äºŒã€æ¢ç´¢
>
> 3ä¸ªæ³¨å†Œä¸­å¿ƒçš„æ·»åŠ æµç¨‹å¤§è‡´æ˜¯ä¸€è‡´çš„ï¼Œæˆ‘ä»¬ä»¥**Nacosä¸ºä¾‹å­**æ¥è¿›è¡Œæœ¬æ¬¡prçš„æ¢ç´¢ã€‚
>
> å…ˆæ•´ä½“çœ‹ä¸‹prçš„æ‰€æœ‰æäº¤ï¼Œä»£ç çš„æ ¸å¿ƒåœ¨**NacosDiscoveryService**æˆ‘ä»¬é‡ç‚¹å…³æ³¨ä¸‹ã€‚è€ŒShenyuDiscoveryServiceä½œä¸ºåº•å±‚æ¥å£æ¥å®šä¹‰å­ç±»çš„**è¡Œä¸ºåŠ¨ä½œ**ï¼Œæœ€åAdminæ¨¡å—å°±æ˜¯æ¥æ§åˆ¶æˆ‘ä»¬è‡ªå®šä¹‰çš„æ³¨å†Œä¸­å¿ƒã€‚
>
> ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/direct/e422dc41c972419a9f5c7d28f5918b51.png#pic_center)
>
>
> æˆ‘ä»¬å›é¡¾ä¸Šæ–‡æˆ‘ä»¬æ•´ç†çš„**é˜…è¯»çº¿ç´¢2**ï¼šè¿™äº›**å‘ç°æœåŠ¡**æ˜¯æ€ä¹ˆå’Œé¡¹ç›®é›†æˆçš„ï¼Œè®©ShenYuç½‘å…³èƒ½ä»æ³¨å†Œä¸­å¿ƒè·å–èŠ‚ç‚¹ä¿¡æ¯ã€‚
>
> å…ˆçœ‹ä¸‹**NacosDiscoveryService**æ˜¯æ€ä¹ˆè·å–èŠ‚ç‚¹ä¿¡æ¯çš„ã€‚å¯ä»¥çœ‹åˆ°ï¼ŒShenYuç½‘å…³é€šè¿‡é…ç½®å’ŒNacoså»ºç«‹è¿æ¥åï¼Œé€šè¿‡Nacosæä¾›çš„**NamingService.selectInstances**æ¥è·å–èŠ‚ç‚¹æœåŠ¡åˆ—è¡¨ã€‚
>
> ```java
>     @Override
>     public List<String> getRegisterData(final String key) {
>         try {
>             List<Instance> instances = namingService.selectInstances(key, groupName, true);
>             List<String> registerData = new ArrayList<>();
>             for (Instance instance : instances) {
>                 String data = buildInstanceInfoJson(instance);
>                 registerData.add(data);
>             }
>             return registerData;
>         } catch (NacosException e) {
>             LOGGER.error("Error getting Nacos service instances: {}", e.getMessage(), e);
>             throw new ShenyuException(e);
>         }
>     }
> ```
>
> é‚£**NacosDiscoveryService**ç±»çš„å…¶ä»–æ–¹æ³•åˆæ˜¯ä»€ä¹ˆä½œç”¨ã€‚
>
> ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/direct/415804eddfd548cd809ef9d74f69c165.png#pic_center)
>
>
> æˆ‘ä»¬çœ‹ä¸‹**watchæ–¹æ³•**çš„å…¥å‚**DataChangedEventListener**ï¼Œè€Œwatchæ–¹æ³•å†…éƒ¨åˆçœ‹åˆ°äº†`listenerMap.put(key, nacosListener)`ã€‚å¯ä»¥æ¸…æ¥šçš„çŸ¥é“watchæ–¹æ³•çš„ä½œç”¨å°±æ˜¯è®©ShenYuç½‘å…³å¯ä»¥åœ¨Nacosæ³¨å†Œä¸­å¿ƒï¼Œ**ç›‘å¬**åˆ°æŸä¸ªæœåŠ¡èŠ‚ç‚¹çš„åŠ¨æ€å˜åŒ–ã€‚
>
> è€Œunwatchæ–¹æ³•ï¼Œé¡¾åæ€ä¹‰ä½œç”¨æ˜¯åè¿‡æ¥çš„ã€‚
>
> ```java
>     @Override
>     public void watch(final String key, final DataChangedEventListener listener) {
>         try {
>             if (!listenerMap.containsKey(key)) {
>                 List<Instance> initialInstances = namingService.selectInstances(key, groupName, true);
>                 instanceListMap.put(key, initialInstances);
>                 EventListener nacosListener = event -> {
>                     if (event instanceof NamingEvent) {
>                         try {
>                             List<Instance> previousInstances = instanceListMap.get(key);
>                             List<Instance> currentInstances = namingService.selectInstances(key, groupName, true);
>                             compareInstances(previousInstances, currentInstances, listener);
>                             instanceListMap.put(key, currentInstances);
>                         } catch (NacosException e) {
>                             throw new ShenyuException(e);
>                         }
>                     }
>                 };
>                 namingService.subscribe(key, groupName, nacosListener);
>                 listenerMap.put(key, nacosListener);
>                 LOGGER.info("Subscribed to Nacos updates for key: {}", key);
>             }
>         } catch (NacosException e) {
>             LOGGER.error("nacosDiscoveryService error watching key: {}", key, e);
>             throw new ShenyuException(e);
>         }
>     }
> 
>     @Override
>     public void unwatch(final String key) {
>         try {
>             EventListener nacosListener = listenerMap.get(key);
>             if (Objects.nonNull(nacosListener)) {
>                 namingService.unsubscribe(key, groupName, nacosListener);
>                 listenerMap.remove(key);
>                 LOGGER.info("Nacos Unwatch key: {}", key);
>             }
>         } catch (NacosException e) {
>             LOGGER.error("Error removing Nacos service listener: {}", e.getMessage(), e);
>             throw new ShenyuException(e);
>         }
>     }
> 
> ```
>
> æˆ‘ä»¬çœ‹ä¸‹**registeræ–¹æ³•**ï¼ŒShenYuç½‘å…³è¿˜æä¾›é€šè¿‡è¯¥æ–¹æ³•è®©æˆ‘ä»¬å¯ä»¥æ³¨å†ŒæŸä¸ªèŠ‚ç‚¹åˆ°Nacosæ³¨å†Œä¸­å¿ƒã€‚åŒæ ·æ˜¯è°ƒç”¨äº†Nacosæä¾›çš„**NamingService**æœåŠ¡ã€‚
>
> ```java
>     @Override
>     public void register(final String key, final String value) {
>         try {
>             Instance instance = GsonUtils.getInstance().fromJson(value, Instance.class);
>             namingService.registerInstance(key, groupName, instance);
>             LOGGER.info("Registering service with key: {} and value: {}", key, value);
>         } catch (NacosException e) {
>             LOGGER.error("Error registering Nacos service instance: {}", e.getMessage(), e);
>             throw new ShenyuException(e);
>         }
>     }
> 
> ```
>
> å¤§å®¶è¿˜æ²¡æœ‰å¿˜è®°**çº¿ç´¢1**å§ï¼ˆè´¡çŒ®è€…æ˜¯**æ€ä¹ˆæ·»åŠ **å‘ç°æœåŠ¡çš„ï¼‰ï¼Œè¿æˆ‘éƒ½å·®ç‚¹å¿˜è®°äº†ğŸ¤£
>
> æˆ‘ä»¬çœ‹ä¸‹ä¸Šæ–‡å›¾2æåˆ°çš„**ShenyuDiscoveryService**æ¥å£ï¼Œå…¶å®è´¡çŒ®è€…å°±æ˜¯æŒ‰è¿™ä¸ªåº•å±‚æ¥å£ä¸ºæ–¹å‘ï¼Œåº•å±‚æ¥å£å®šä¹‰äº†**æ–°æ¥å…¥çš„æ³¨å†Œä¸­å¿ƒ**ï¼Œéœ€è¦å®ç°å“ªäº›è¡Œä¸ºã€æ–¹æ³•çš„å…¥å‚æ˜¯ä»€ä¹ˆã€è§„èŒƒæ˜¯ä»€ä¹ˆã€‚
>
> ä»¥åº•å±‚æ¥å£ä¸ºæ–¹å‘ï¼Œæ·»åŠ æ–°çš„æ³¨å†Œä¸­å¿ƒå‘ç°æœåŠ¡å…¶å®å°±ç±»ä¼¼äº**SPIçš„æ¥å…¥**ã€‚
>
> > SPIä¸APIåŒºåˆ«
> >
> > - APIæ˜¯è°ƒç”¨å¹¶ç”¨äºå®ç°ç›®æ ‡çš„ç±»ã€æ¥å£ã€æ–¹æ³•ç­‰çš„æè¿°ï¼›
> > - SPIæ˜¯æ‰©å±•å’Œå®ç°ä»¥å®ç°ç›®æ ‡çš„ç±»ã€æ¥å£ã€æ–¹æ³•ç­‰çš„æè¿°ï¼›
>
>
> å¥½äº†ï¼Œä»Šå¤©çš„åˆ†äº«å°±åˆ°è¿™äº†ã€‚**å¤§å®¶èƒ½å¦æ„Ÿå—é€šè¿‡PRã€ISSUEè¿™ç§æ–¹å¼æ¥é˜…è¯»æºç çš„ä¹è¶£å‘¢ï¼** 
>
> > åšä¸»çš„GitHubä¹Ÿæœ‰ä¸€äº›è¯»è€…æ„Ÿå…´è¶£çš„çŸ¥è¯†å¯ä»¥å­¦ä¹ ğŸ˜ï¼Œ[GitHubåœ°å€æˆ³è¿™](https://github.com/hdgaadd)
> >
> > <br/>
> >
> > **åˆ›ä½œä¸æ˜“ï¼Œä¸å¦¨ç‚¹èµã€å…³æ³¨ã€æ”¶è—æ”¯æŒä¸€ä¸‹ï¼Œå„ä½çš„æ”¯æŒå°±æ˜¯æˆ‘åˆ›ä½œçš„æœ€å¤§åŠ¨åŠ›**â¤ï¸
